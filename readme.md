
# Sudoku Web Solver: A Hybrid GAS-Based Solution

這個專案是一個以 **Google Apps Script (GAS)** 為後端、純瀏覽器（HTML + jQuery）為前端的互動式數獨解題系統。它採用了獨特的混合式架構，旨在平衡運算效率與使用者互動體驗。

## 專案特色

  * **混合式架構**：將昂貴的數獨求解運算（回溯法）放在 **GAS 後端**一次性執行，而高頻率、輕量的互動操作（如「下一步」、「填入 N 筆」）則完全在**前端**處理。
  * **高效互動**：系統僅在初始化階段向 GAS 請求並計算完整解答 (`answer`)。之後的所有步驟，前端皆透過比對當前盤面 (`board`) 與完整解答 (`answer`) 的差異來進行漸進式更新與高亮顯示，大幅減少了後端呼叫次數，提高了互動流暢性。
  * **狀態管理**：核心狀態模型包含 `qboard`（原始題目）、`board`（當前盤面）和 `answer`（完整解答）。
  * **核心演算法**：後端採用典型的\*\*回溯法（Backtracking）\*\*來尋找數獨解答。
  * **簡潔部署**：專案以 Web App 形式部署於 Google Apps Script，執行身分為「我」，可供「任何人」存取。

-----

## 系統架構與流程

1.  **使用者輸入題目**：在 9x9 的表格中輸入數獨題目。
2.  **初始化解題**：前端將題目 (`qboard`) 傳送至 GAS 後端。
3.  **後端計算與回傳**：GAS 使用回溯法求解並產生完整的 `answer`，隨後將其一次性回傳給前端。
4.  **前端互動模式**：進入互動模式後，使用者可點擊以下按鈕：
      * **「下一步」**：前端掃描 `board`，找到第一個空格 (`0`)，並以 `answer` 中的值填入，同時高亮顯示。
      * **「填入 N 筆答案」**：一次性填入多個空格。
      * **「重置」**：將 `board` 恢復為原始題目 `qboard`。

-----

## 資料交換格式 (JSON)

### 請求 (前端 -\> 後端)

```json
{
  "action": "init",
  "data": {
    "qboard": [[...9x9...]],
    "board": [[...9x9...]],
    "answer": []
  }
}
```

### 回應 (後端 -\> 前端)

```json
{
  "status": "ok",
  "message": "初始化完成",
  "data": {
    "qboard": [[...9x9...]],
    "board": [[...9x9...]],
    "answer": [[...9x9...]]
  }
}
```

-----

## 如何執行 (GAS 專案部署)

1.  在 Google Apps Script 中建立一個新專案。
2.  **核心前端邏輯**：將報告中附錄 A 的 JavaScript 程式碼複製到一個 `.html` 檔案中 (例如 `Index.html`)。
3.  **核心後端邏輯**：將報告中附錄 B 的 Google Apps Script 程式碼複製到一個 `.gs` 檔案中 (例如 `Code.gs`)。
4.  **部署為 Web App**：
      * 在 GAS 編輯器中，點擊 **部署 \> 新增部署**。
      * 選擇 **網路應用程式** 作為部署類型。
      * 設定 **執行身分** 為「我」。
      * 設定 **可存取對象** 為「任何人」。
      * 部署後，複製產生的 URL，即可在瀏覽器中開啟並使用。
5.  **更新程式碼**：每次更新後，記得點擊 **管理部署 \> 編輯 \> 部署** 來更新部署，確保 Web App 指向最新版本。

-----

## 未來改進方向

  * **多使用者隔離**：以 token/session key 方式區分 GAS 端狀態。
  * **合法性驗證與提示**：前端輸入題目時立即檢查行列宮是否存在矛盾。
  * **多解答列舉**：支援「列出前N個完整解答」並提供切換顯示。
  * **更豐富的前端提示**：例如候選數標註（pencil marks）、邏輯推理過程視覺化。
  * **錯誤復原/撤銷 (Undo/Redo)**：提供操作歷程回放。
  * **單元測試/端到端測試**：以 GAS + Jest (或 clasp + 本地模擬) 強化可靠性。
  * **權限與安全**：更細緻地限制 Web App 的可訪問對象與頻率。

-----

**提示：**

你可以將每個功能點都變成一個 Markdown 連結，指向程式碼中相對應的部分，這樣讀者在看 README 時，可以直接點擊連結跳轉到程式碼，會更方便喔！

例如：

```markdown
[**核心演算法**](link_to_your_backtracking_code.gs)
```